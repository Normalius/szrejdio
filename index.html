<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SZRejdio :: www.szrejdio.pl</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
<header>
    <div class="logo-centered">
        <img src="images/logo.png" alt="SZRejdio Logo">
    </div>
    <div class="actions">
        <button class="action-button">Kontakt</button>
        <button class="action-button">Wsparcie</button>
    </div>
</header>
<nav>
    <ul>
        <li><a href="#"><i class="fas fa-home"></i> Index</a></li>
        <li><a href="#"><i class="fas fa-newspaper"></i> Aktualności</a></li>
        <li><a href="#"><i class="fas fa-comments"></i> Forum</a></li>
        <li><a href="#"><i class="fas fa-headphones"></i> Jak słuchać?</a></li>
        <li><a href="#"><i class="fas fa-calendar-alt"></i> Ramówka</a></li>
        <li><a href="#"><i class="fas fa-users"></i> Ekipa</a></li>
        <li><a href="#"><i class="fas fa-music"></i> Audycje</a></li>
        <li><a href="#"><i class="fas fa-star"></i> Lista Przebojów</a></li>
        <li><a href="#"><i class="fas fa-question-circle"></i> Pomoc</a></li>
    </ul>
</nav>
<div id="greetingModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Wyślij pozdrowienie</h2>
        <form id="greetingForm" action="send_greeting.php" method="post">
            <label for="greetingName">Imię:</label>
            <input type="text" id="greetingName" name="name" required>
            <label for="greetingMessage">Pozdrowienie:</label>
            <textarea id="greetingMessage" name="message" rows="4" required></textarea>
            <button type="submit">Wyślij</button>
        </form>
    </div>
</div>

<div id="songModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Wyślij piosenkę</h2>
        <!-- Formularz do wysyłania piosenki -->
    </div>
</div>
    <!-- Sekcja na statystyki radia -->
    <div id="radioStats" class="radio-stats">
        <h2>Statystyki Radia</h2>
        <ul>
            <li>Nazwa: <span id="radioName">...</span></li>
            <li>Prowadzący: <span id="host">...</span></li>
            <li>Słucha: <span id="listeners">...</span></li>
            <li>Maxymalnie słuchało: <span id="maxListeners">...</span></li>
            <li>Aktualnie: <span id="currentListeners">...</span></li>
        </ul>
    </div>

<main>
    <section class="news-section">
        <h2>Aktualności</h2>
        <ul class="news-list">
            <li>
                <h3>Nowy program na antenie - "Szalona Niedziela"</h3>
                <p>Mamy przyjemność ogłosić premierę naszego najnowszego programu radiowego - "Szalona Niedziela"! To niezwykłe wydarzenie, które ma na celu zapewnić Ci rozrywkę i radość w każdą niedzielę wieczorem.</p>
                <p>W programie "Szalona Niedziela" możesz spodziewać się dynamicznej muzyki, fascynujących rozmów z gośćmi specjalnymi oraz konkursów z atrakcyjnymi nagrodami. Przygotuj się na niezapomniane doświadczenie, które sprawi, że każda niedziela stanie się wyjątkowa!</p>
                <p>Dołącz do nas już w najbliższą niedzielę o godzinie 20:00 i weź udział w szalonym show, które rozświetli Twój wieczór!</p>
                <p>Nie przegap premiery programu "Szalona Niedziela" tylko na SZRejdio!</p>
            </li>
        </ul>
    </section>
</main>

<footer>
    <div class="footer-links">
        <a href="#">Kontakt</a>
        <a href="#">Wsparcie</a>
        <a href="#">Regulamin</a>
        <a href="#">Polityka prywatności</a>
    </div>
    <div class="footer-info">
        <p>Copyright&copy; SZRejdio&reg; 2013</p>
        <p>Powered by: SZR.Script v3.0</p>
        <div class="social-media">
            <a href="#"><i class="fab fa-facebook-f"></i></a>
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
        </div>
    </div>
</footer>

    <?php
/**
* SHOUTcast 2 statistics class
*
* @author Slotex.pl / PortalRadiowy.pl
* @copyright 2016 Slotex.pl
* @version 1.3
*/
class shoutcast2stats {
    private $_ip;
    private $_port;
    private $_sid;
    private $_json;
 
    public function __construct($ip, $port, $sid=1)
    {
        $this->_ip = $ip;
        $this->_port = $port;
        $this->_sid = $sid;
        $this->initCurl();
    }
 
    private function initCurl()
    {
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, 'http://'.$this->_ip.':'.$this->_port.'/stats?sid='.$this->_sid.'&json=1');
        curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (PortalRadiowy.pl)');
        curl_setopt($ch, CURLOPT_HEADER, 0);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_TIMEOUT, 3);
        $curl_exec = curl_exec($ch);
        $this->_json = ($curl_exec ? json_decode(iconv('UTF-8', 'UTF-8//IGNORE', $curl_exec)) : false);
        curl_close($ch);
    }
   
    public function get($name, $name_dj='')
    {
        if ($name == 'streamstatus') {
            if ($this->_json == false) {
                return 0;
            } elseif ($this->_json->streamstatus == 0) {
                return 1;
            } else {
                return 2;
            }
        } elseif (isset($this->_json->$name) && $name == 'dj' && !empty($name_dj)) {
            $dj_json = json_decode(substr(preg_replace('/\},[\s]*\{/', ',', preg_replace(array('/\([\s]*"/', '/"[\s]*\)/', '/"[\s]*,/'), array('{"', '"}', '":'), preg_replace_callback('/\\\\(\d+)/m', function($matches) { return iconv('Windows-1250', 'UTF-8//IGNORE', chr($matches[1])); }, $this->_json->dj))), 1, -1));
            if (isset($dj_json->$name_dj)) {
                return htmlspecialchars($dj_json->$name_dj);
            }
        } elseif (isset($this->_json->$name)) {
            return htmlspecialchars($this->_json->$name);
        }
        return '';
    }
}



/**
* Inicjalizacja klasy:
* ip-serwera - Zamień na adres IP swojego serwera SHOUTcast 2
* 8000 - Zamień na port swojego serwera SHOUTcast 2
*
* Opcjonalnie:
* Po argumencie z numerem portu, możesz wstawić argument z numerem streamu (kanału) sid, domyślnie: 1
* $stats = new shoutcast2stats('ip-serwera', 8000, 2); // Dla stream id: 2
*/
$stats = new shoutcast2stats('ip-serwera', 8000);
echo $stats->get('streamstatus'); // Informuje o stanie serwera: 0 - wyłączony, 1 - włączony (nikt nie nadaje), 2 - włączony (prowadzona jest transmisja)
echo $stats->get('currentlisteners'); // Aktualna ilość słuchaczy
echo $stats->get('uniquelisteners'); // Ilość unikalnych słuchaczy (zlicza na podstawie unikalnych adresów IP), wartość pola "Listener Peak"
echo $stats->get('peaklisteners'); // Rekord słuchaczy (ta wartość resetuje się w momencie restartu serwera SHOUTcast 2)
echo $stats->get('maxlisteners'); // Maksymalna ilość słuchaczy (ilość slotów)
echo $stats->get('servertitle'); // Wyświetla wartość pola "Stream Name", czyli często uznawane jako "Nazwa audycji". Poprawnie powinno odpowiadać za nazwę radia.
echo $stats->get('servergenre'); // Wyświetla wartość pola "Stream Genre(s)", czyli często uznawane jako "Nazwa prezentera". Poprawnie powinno odpowiadać za gatunki odgrywanej muzyki.
echo $stats->get('songtitle'); // Wyświetla wartość pola "Playing Now", czyli nazwa aktualnie odgrywanego utworu lub teksty E-RDS.
echo $stats->get('dj'); // Wyświetla wartość pola "dj" (pole dostępne tylko w statystykach).
// UWAGA! Poniższe opcje są dostępne tylko do usług Auto DJ zakupionych w firmie Slotex.pl, jeżeli korzystasz z funkcjonalności "Live DJ".
echo $stats->get('dj', 'icy-name'); // Wyświetla wartość pola "Name" wpisaną w programie do nadawania, czyli często uznawane jako "Nazwa audycji".
echo $stats->get('dj', 'icy-genre'); // Wyświetla wartość pola "Genre" wpisaną w programie do nadawania, czyli często uznawane jako "Nazwa prezentera".

    <?php
        // Kod PHP do pobierania statystyk radia
        $ip_serwera = 's3.slotex.pl';
        $port_serwera = 7466;
        $sid_streamu = 1;
        $stats = new shoutcast2stats($ip_serwera, $port_serwera, $sid_streamu);
    ?>
    

<script src="script.js"></script>
</body>
</html>
